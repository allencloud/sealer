name: Markdown Link Check

on:
  push:
    branches: "*"
  pull_request:
    branches: "*"
    paths:
      - '*.md'
jobs:
  lint-markdown-docs:
    name: Lint markdown file
    runs-on: ubuntu-latest
    steps:
    - name: Check out code
      uses: actions/checkout@v2

    - name: Lint markdown file
      uses: docker://dragonflyoss/linter:v0.2.7
      with:
        args: bash -c "set +e
            for name in $(find . -name \*.md | grep -v vendor | grep -v CHANGELOG); do 
              if [ -f $name ]; then 
                markdown-link-check -q $name; 
                if [ $? -ne 0 ]; then
                  code=1
                fi
              fi 
            done 
            bash -c 'exit $code';"

